<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>開盤八法盤勢分析器 - 詳細解析版</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        header {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #1e5799 0%, #207cca 100%);
            color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        header h1 {
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }
        
        .input-section, .result-section {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            font-size: 1.5rem;
            color: #1e5799;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eaeaea;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #207cca;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.1rem;
            transition: border-color 0.3s;
        }
        
        .input-group input:focus {
            border-color: #1e5799;
            outline: none;
            box-shadow: 0 0 0 2px rgba(30, 87, 153, 0.2);
        }
        
        .input-hint {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 14px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: #1e5799;
            color: white;
            flex: 2;
        }
        
        .btn-primary:hover {
            background-color: #16457a;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: #f0f0f0;
            color: #333;
            flex: 1;
        }
        
        .btn-secondary:hover {
            background-color: #e0e0e0;
        }
        
        .result-display {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            background-color: #f9f9f9;
            border-left: 5px solid #1e5799;
        }
        
        .method-name {
            font-size: 1.8rem;
            color: #1e5799;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .method-description {
            font-size: 1.1rem;
            line-height: 1.7;
            margin-bottom: 15px;
        }
        
        .price-comparison {
            display: flex;
            justify-content: space-between;
            margin: 25px 0;
            padding: 15px;
            background-color: #f0f7ff;
            border-radius: 8px;
        }
        
        .price-point {
            text-align: center;
            flex: 1;
        }
        
        .price-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }
        
        .price-value {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .price-status {
            font-size: 0.9rem;
            padding: 3px 10px;
            border-radius: 15px;
            display: inline-block;
        }
        
        .up {
            color: #e53935;
            background-color: rgba(229, 57, 53, 0.1);
        }
        
        .down {
            color: #2e7d32;
            background-color: rgba(46, 125, 50, 0.1);
        }
        
        .method-explanation {
            background-color: #fff9e6;
            padding: 20px;
            border-radius: 8px;
            margin-top: 25px;
            border-left: 5px solid #ff9800;
        }
        
        .explanation-title {
            font-size: 1.3rem;
            color: #e65100;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .explanation-content {
            line-height: 1.7;
        }
        
        .operation-section {
            background-color: #e8f5e9;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 5px solid #4caf50;
        }
        
        .operation-title {
            font-size: 1.3rem;
            color: #2e7d32;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .operation-content {
            line-height: 1.7;
        }
        
        .key-points {
            background-color: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 5px solid #2196f3;
        }
        
        .key-points-title {
            font-size: 1.3rem;
            color: #1565c0;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .key-points-list {
            padding-left: 20px;
        }
        
        .key-points-list li {
            margin-bottom: 8px;
        }
        
        .strength-indicator {
            display: flex;
            align-items: center;
            margin-top: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 8px;
        }
        
        .strength-label {
            font-weight: 600;
            margin-right: 15px;
            min-width: 120px;
        }
        
        .strength-bar {
            flex: 1;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .strength-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .strength-weak {
            background-color: #f44336;
            width: 25%;
        }
        
        .strength-moderate {
            background-color: #ff9800;
            width: 50%;
        }
        
        .strength-strong {
            background-color: #4caf50;
            width: 75%;
        }
        
        .strength-very-strong {
            background-color: #2e7d32;
            width: 100%;
        }
        
        .method-list {
            margin-top: 30px;
            padding: 20px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .method-list h3 {
            color: #1e5799;
            margin-bottom: 15px;
        }
        
        .method-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .method-item:last-child {
            border-bottom: none;
        }
        
        .method-number {
            background-color: #1e5799;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .method-pattern {
            font-weight: 600;
            min-width: 120px;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .content {
                flex-direction: column;
            }
            
            .price-comparison {
                flex-direction: column;
                gap: 15px;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .strength-indicator {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .strength-label {
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-chart-line"></i> 開盤八法盤勢分析器 - 詳細解析版</h1>
            <p>根據前日收盤價與開盤後三個時間點的價格，判斷開盤八法類型及詳細盤勢解析與操作建議</p>
        </header>
        
        <div class="content">
            <div class="input-section">
                <h2 class="section-title"><i class="fas fa-edit"></i> 輸入價格數據</h2>
                
                <div class="input-group">
                    <label for="prev-close">前日收盤價</label>
                    <input type="number" id="prev-close" step="0.01" min="0" placeholder="請輸入���日收盤價">
                    <div class="input-hint">這是比較基準價，用來判斷後續價格是漲還是跌</div>
                </div>
                
                <div class="input-group">
                    <label for="price-9-05">9:05分收盤價 (A)</label>
                    <input type="number" id="price-9-05" step="0.01" min="0" placeholder="請輸入9:05分的收盤價">
                    <div class="input-hint">開盤後第一個5分鐘的收盤價</div>
                </div>
                
                <div class="input-group">
                    <label for="price-9-10">9:10分收盤價 (B)</label>
                    <input type="number" id="price-9-10" step="0.01" min="0" placeholder="請輸入9:10分的收盤價">
                    <div class="input-hint">開盤後第二個5分鐘的收盤價</div>
                </div>
                
                <div class="input-group">
                    <label for="price-9-15">9:15分收盤價 (C)</label>
                    <input type="number" id="price-9-15" step="0.01" min="0" placeholder="請輸入9:15分的收盤價">
                    <div class="input-hint">開盤後第三個5分鐘的收盤價</div>
                </div>
                
                <div class="buttons">
                    <button class="btn btn-primary" id="analyze-btn">
                        <i class="fas fa-calculator"></i> 分析開盤八法
                    </button>
                    <button class="btn btn-secondary" id="reset-btn">
                        <i class="fas fa-redo"></i> 重置數據
                    </button>
                </div>
            </div>
            
            <div class="result-section">
                <h2 class="section-title"><i class="fas fa-chart-bar"></i> 分析結果</h2>
                
                <div id="result-display" class="result-display" style="display: none;">
                    <div class="price-comparison" id="price-comparison">
                        <!-- 動態生成價格比較 -->
                    </div>
                    
                    <div class="method-name" id="method-name">等待分析結果...</div>
                    
                    <div class="method-description" id="method-description">
                        請輸入價格數據後點擊"分析開盤八法"按鈕
                    </div>
                    
                    <div class="strength-indicator">
                        <div class="strength-label">多方強度：</div>
                        <div class="strength-bar">
                            <div class="strength-fill" id="strength-fill"></div>
                        </div>
                    </div>
                    
                    <div class="method-explanation">
                        <div class="explanation-title">
                            <i class="fas fa-info-circle"></i> 盤勢解析
                        </div>
                        <div class="explanation-content" id="method-explanation">
                            分析結果將顯示在這裡
                        </div>
                    </div>
                    
                    <div class="operation-section">
                        <div class="operation-title">
                            <i class="fas fa-tasks"></i> 操作建議
                        </div>
                        <div class="operation-content" id="operation-advice">
                            操作建議將顯示在這裡
                        </div>
                    </div>
                    
                    <div class="key-points">
                        <div class="key-points-title">
                            <i class="fas fa-key"></i> 關鍵觀察點
                        </div>
                        <div class="key-points-content">
                            <ul class="key-points-list" id="key-points">
                                <!-- 動態生成關鍵觀察點 -->
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div id="initial-message" class="result-display">
                    <p style="text-align: center; color: #666;">
                        <i class="fas fa-arrow-left" style="font-size: 1.5rem; margin-bottom: 15px; display: block;"></i>
                        請在左側輸入價格數據，然後點擊"分析開盤八法"按鈕
                    </p>
                </div>
            </div>
        </div>
        
        <div class="method-list">
            <h3><i class="fas fa-list-ol"></i> 開盤八法類型對照表</h3>
            <div class="method-item">
                <div class="method-number">1</div>
                <div class="method-pattern">三漲</div>
                <div class="method-desc">A漲、B漲、C漲 (A>前日收盤, B>A, C>B)</div>
            </div>
            <div class="method-item">
                <div class="method-number">2</div>
                <div class="method-pattern">二漲一跌</div>
                <div class="method-desc">A漲、B漲、C跌 (A>前日收盤, B>A, C<B)</div>
            </div>
            <div class="method-item">
                <div class="method-number">3</div>
                <div class="method-pattern">一漲二跌</div>
                <div class="method-desc">A漲、B跌、C跌 (A>前日收盤, B<A, C<B)</div>
            </div>
            <div class="method-item">
                <div class="method-number">4</div>
                <div class="method-pattern">三跌</div>
                <div class="method-desc">A跌、B跌、C跌 (A<前日收盤, B<A, C<B)</div>
            </div>
            <div class="method-item">
                <div class="method-number">5</div>
                <div class="method-pattern">二跌一漲</div>
                <div class="method-desc">A跌、B跌、C漲 (A<前日收盤, B<A, C>B)</div>
            </div>
            <div class="method-item">
                <div class="method-number">6</div>
                <div class="method-pattern">一跌二漲</div>
                <div class="method-desc">A跌、B漲、C漲 (A<前日收盤, B>A, C>B)</div>
            </div>
            <div class="method-item">
                <div class="method-number">7</div>
                <div class="method-pattern">一漲一跌一漲</div>
                <div class="method-desc">A漲、B跌、C漲 (A>前日收盤, B<A, C>B)</div>
            </div>
            <div class="method-item">
                <div class="method-number">8</div>
                <div class="method-pattern">一跌一漲一跌</div>
                <div class="method-desc">A跌、B漲、C跌 (A<前日收盤, B>A, C<B)</div>
            </div>
        </div>
        
        <footer>
            <p>本工具根據雲發理財網的開盤八法原理設計 | 僅供參考，投資有風險，請謹慎決策</p>
            <p>參考來源: https://www.yunfar.com.tw/GBSSKILL/starting-8ways.html</p>
        </footer>
    </div>

    <script>
        // 開盤八法的詳細解析資料
        const openingMethods = {
            1: {
                name: "第一法：三漲",
                description: "連續三根5分鐘K線收盤價都比前日收盤價高",
                strength: "very-strong",
                explanation: "盤勢解析：開高走高，氣勢強勁，顯示多方完全掌控盤勢。開盤後連續三個時間點都創新高，代表買盤積極，空方無力抵抗。通常出現在強勢多頭行情或重大利多消息公布後。",
                operation: "操作建議：積極做多，可以考慮追價買進或加碼多單。停損點可設在9:15收盤價下方。若成交量同步放大，上漲趨勢更為可靠。",
                keyPoints: [
                    "觀察成交量是否同步放大，確認買盤力道",
                    "注意是否出現過熱跡象，如漲幅過大或量能暴增",
                    "若盤中出現拉回，應觀察是否守住9:15低點",
                    "留意大盤是否同步走強，確認多頭環境"
                ]
            },
            2: {
                name: "第二法：二漲一跌",
                description: "A漲、B漲、C跌 (9:05漲，9:10漲，9:15跌)",
                strength: "moderate",
                explanation: "盤勢解析：開高後創高但拉回，顯示高檔有賣壓出現。多方雖然在前兩個時間點占優勢，但在第三個時間點遭遇空方反擊，形成高檔獲利了結賣壓。",
                operation: "操作建議：謹慎做多，可等待拉回支撐時進場。不宜追高，可考慮在9:15低點附近尋找買點，停損設在該點位下方。",
                keyPoints: [
                    "觀察9:15的下跌幅度，判斷賣壓強度",
                    "注意9:10高點是否形成短期壓力",
                    "觀察後續是否能在9:05低點上方獲得支撐",
                    "注意成交量變化，下跌是否帶量"
                ]
            },
            3: {
                name: "第三法：一漲二跌",
                description: "A漲、B跌、C跌 (9:05漲，9:10跌，9:15跌)",
                strength: "weak",
                explanation: "盤勢解析：開高後連續走低，顯示開盤的買盤只是曇花一現，空方迅速掌握盤勢。這種模式常出現在反彈無力或利多出盡的情況，顯示市場信心不足。",
                operation: "操作建議：偏向空方操作，可考慮逢高放空或減碼多單。反彈至9:05高點附近是較好的空點，停損可設在該點位上方。",
                keyPoints: [
                    "觀察是否跌破前日收盤價，確認空頭趨勢",
                    "注意9:05高點是否形成強力壓力",
                    "觀察下跌時是否帶量，確認空方力道",
                    "留意是否出現止跌訊號，判斷下跌是否結束"
                ]
            },
            4: {
                name: "第四法：三跌",
                description: "連續三根5分鐘K線收盤價都比前日收盤價低",
                strength: "very-strong",
                explanation: "盤勢解析：開低走低，空方完全掌控盤勢。開盤後連續三個時間點都創新低，代表賣壓沉重，多方無力抵抗。通常出現在強勢空頭行情或重大利空消息公布後。",
                operation: "操作建議：積極做空，可以考慮追價放空或加碼空單。停損點可設在9:15收盤價上方。若成交量同步放大，下跌趨勢更為可靠。",
                keyPoints: [
                    "觀察成交量是否同步放大，確認賣壓力道",
                    "注意是否出現超跌跡象，可能醞釀反彈",
                    "若盤中出現反彈，應觀察是否受壓於9:15高點",
                    "留意大盤是否同步走弱，確認空頭環境"
                ]
            },
            5: {
                name: "第五法：二跌一漲",
                description: "A跌、B跌、C漲 (9:05跌，9:10跌，9:15漲)",
                strength: "moderate",
                explanation: "盤勢解析：開低後續低但反彈，顯示低檔有買盤支撐。空方雖然在前兩個時間點占優勢，但在第三個時間點遭遇多方反擊，形成低檔承接買盤。",
                operation: "操作建議：謹慎做空，可等待反彈壓力時進場放空。不宜追空，可考慮在9:15高點附近尋找空點，停損設在該點位上方。",
                keyPoints: [
                    "觀察9:15的上漲幅度，判斷買盤強度",
                    "注意9:10低點是否形成短期支撐",
                    "觀察後續是否能在9:05高點下方遭遇壓力",
                    "注意成交量變化，上漲是否帶量"
                ]
            },
            6: {
                name: "第六法：一跌二漲",
                description: "A跌、B漲、C漲 (9:05跌，9:10漲，9:15漲)",
                strength: "moderate",
                explanation: "盤勢解析：開低後連續走高，顯示開盤的賣壓迅速被消化，多方積極進場。這種模式常出現在洗盤結束或利空出盡的情況，顯示市場信心恢復。",
                operation: "操作建議：偏向多方操作，可考慮逢低買進或減碼空單。拉回至9:05低點附近是較好的買點，停損可設在該點位下方。",
                keyPoints: [
                    "觀察是否突破前日收盤價，確認多頭趨勢",
                    "注意9:05低點是否形成強力支撐",
                    "觀察上漲時是否帶量，確認多方力道",
                    "留意是否出現過熱訊號，判斷上漲是否結束"
                ]
            },
            7: {
                name: "第七法：一漲一跌一漲",
                description: "A漲、B跌、C漲 (9:05漲，9:10跌，9:15漲)",
                strength: "strong",
                explanation: "盤勢解析：開高後拉回再創高，呈現震盪走高格局。多方在遭遇空方抵抗後，仍能再次發動攻勢創高，顯示多方力道仍強，但走勢可能較為震盪。",
                operation: "操作建議：震盪偏多操作，可在拉回時買進，創高時部分獲利了結。停損可設在9:10低點下方，目標看能否突破9:15高點。",
                keyPoints: [
                    "觀察9:10低點是否形成有效支撐",
                    "注意9:15是否突破9:05高點，確認多方力道",
                    "觀察成交量是否在上漲時放大",
                    "留意盤中是否出現背離現象"
                ]
            },
            8: {
                name: "第八法：一跌一漲一跌",
                description: "A跌、B漲、C跌 (9:05跌，9:10漲，9:15跌)",
                strength: "weak",
                explanation: "盤勢解析：開低後反彈再走低，呈現震盪走低格局。空方在遭遇多方抵抗後，仍能再次發動攻勢創新低，顯示空方力道仍強，但走勢可能較為震盪。",
                operation: "操作建議：震盪偏空操作，可在反彈時放空，創新低時部分回補。停損可設在9:10高點上方，目標看能否跌破9:15低點。",
                keyPoints: [
                    "觀察9:10高點是否形成有效壓力",
                    "注意9:15是否跌破9:05低點，確認空方力道",
                    "觀察成交量是否在下跌時放大",
                    "留意盤中是否出現背離現象"
                ]
            }
        };
        
        // DOM元素
        const prevCloseInput = document.getElementById('prev-close');
        const price905Input = document.getElementById('price-9-05');
        const price910Input = document.getElementById('price-9-10');
        const price915Input = document.getElementById('price-9-15');
        const analyzeBtn = document.getElementById('analyze-btn');
        const resetBtn = document.getElementById('reset-btn');
        const resultDisplay = document.getElementById('result-display');
        const initialMessage = document.getElementById('initial-message');
        const priceComparison = document.getElementById('price-comparison');
        const methodName = document.getElementById('method-name');
        const methodDescription = document.getElementById('method-description');
        const methodExplanation = document.getElementById('method-explanation');
        const operationAdvice = document.getElementById('operation-advice');
        const keyPoints = document.getElementById('key-points');
        const strengthFill = document.getElementById('strength-fill');
        
        // 分析開盤八法
        function analyzeOpeningMethod() {
            // 獲取輸入值
            const prevClose = parseFloat(prevCloseInput.value);
            const price905 = parseFloat(price905Input.value);
            const price910 = parseFloat(price910Input.value);
            const price915 = parseFloat(price915Input.value);
            
            // 驗證輸入
            if (isNaN(prevClose) || isNaN(price905) || isNaN(price910) || isNaN(price915)) {
                alert('請輸入有效的價格數值');
                return;
            }
            
            if (prevClose <= 0 || price905 <= 0 || price910 <= 0 || price915 <= 0) {
                alert('價格必須大於0');
                return;
            }
            
            // 計算每個時間點相對於前日收盤價的漲跌
            const status905 = price905 > prevClose ? '漲' : '跌';
            const status910 = price910 > price905 ? '漲' : '跌';
            const status915 = price915 > price910 ? '漲' : '跌';
            
            // 判斷開盤八法類型
            let method = 0;
            
            if (status905 === '漲' && status910 === '漲' && status915 === '漲') {
                method = 1; // 三漲
            } else if (status905 === '漲' && status910 === '漲' && status915 === '跌') {
                method = 2; // 二漲一跌
            } else if (status905 === '漲' && status910 === '跌' && status915 === '跌') {
                method = 3; // 一漲二跌
            } else if (status905 === '跌' && status910 === '跌' && status915 === '跌') {
                method = 4; // 三跌
            } else if (status905 === '跌' && status910 === '跌' && status915 === '漲') {
                method = 5; // 二跌一漲
            } else if (status905 === '跌' && status910 === '漲' && status915 === '漲') {
                method = 6; // 一跌二漲
            } else if (status905 === '漲' && status910 === '跌' && status915 === '漲') {
                method = 7; // 一漲一跌一漲
            } else if (status905 === '跌' && status910 === '漲' && status915 === '跌') {
                method = 8; // 一跌一漲一跌
            }
            
            // 顯示結果
            displayResult(method, prevClose, price905, price910, price915);
        }
        
        // 顯示分析結果
        function displayResult(method, prevClose, price905, price910, price915) {
            // 切換顯示結果區域
            resultDisplay.style.display = 'block';
            initialMessage.style.display = 'none';
            
            // 更新價格比較區域
            priceComparison.innerHTML = `
                <div class="price-point">
                    <div class="price-label">前日收盤價</div>
                    <div class="price-value">${prevClose.toFixed(2)}</div>
                    <div class="price-status">基準</div>
                </div>
                <div class="price-point">
                    <div class="price-label">9:05 (A)</div>
                    <div class="price-value">${price905.toFixed(2)}</div>
                    <div class="price-status ${price905 > prevClose ? 'up' : 'down'}">${price905 > prevClose ? '漲' : '跌'}</div>
                </div>
                <div class="price-point">
                    <div class="price-label">9:10 (B)</div>
                    <div class="price-value">${price910.toFixed(2)}</div>
                    <div class="price-status ${price910 > price905 ? 'up' : 'down'}">${price910 > price905 ? '漲' : '跌'}</div>
                </div>
                <div class="price-point">
                    <div class="price-label">9:15 (C)</div>
                    <div class="price-value">${price915.toFixed(2)}</div>
                    <div class="price-status ${price915 > price910 ? 'up' : 'down'}">${price915 > price910 ? '漲' : '跌'}</div>
                </div>
            `;
            
            // 更新開盤八法資訊
            if (method > 0) {
                const methodInfo = openingMethods[method];
                methodName.textContent = methodInfo.name;
                methodDescription.textContent = methodInfo.description;
                methodExplanation.textContent = methodInfo.explanation;
                operationAdvice.textContent = methodInfo.operation;
                
                // 更新關鍵觀察點
                keyPoints.innerHTML = '';
                methodInfo.keyPoints.forEach(point => {
                    const li = document.createElement('li');
                    li.textContent = point;
                    keyPoints.appendChild(li);
                });
                
                // 更新強度指示器
                strengthFill.className = 'strength-fill';
                strengthFill.classList.add(`strength-${methodInfo.strength}`);
                
                // 根據方法類型設定不同的顏色主題
                setResultTheme(method);
            } else {
                methodName.textContent = "無法判斷";
                methodDescription.textContent = "輸入的價格數據無法對應到開盤八法的任何一種模式";
                methodExplanation.textContent = "請確認輸入的價格數據是否正確，或參考下方的開盤八法對照表檢查模式";
                operationAdvice.textContent = "請重新輸入正確的價格數據後再次分析";
                keyPoints.innerHTML = '<li>確認所有價格都已正確輸入</li><li>檢查價格是否符合邏輯（如後續價格不應為負數）</li><li>參考下方的開盤八法對照表確認模式</li>';
                strengthFill.className = 'strength-fill';
            }
            
            // 滾動到結果區域
            resultDisplay.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // 根據方法類型設定結果主題
        function setResultTheme(method) {
            // 根據方法類型設定不同的顏色主題
            const resultDisplay = document.getElementById('result-display');
            
            // 移除現有主題類別
            resultDisplay.classList.remove('theme-bullish', 'theme-bearish', 'theme-neutral');
            
            // 添加新主題類別
            if (method === 1 || method === 6 || method === 7) {
                // 多方主導的方法
                resultDisplay.classList.add('theme-bullish');
            } else if (method === 3 || method === 4 || method === 8) {
                // 空方主導的方法
                resultDisplay.classList.add('theme-bearish');
            } else {
                // 中性或震盪的方法
                resultDisplay.classList.add('theme-neutral');
            }
        }
        
        // 重置輸入
        function resetInputs() {
            prevCloseInput.value = '';
            price905Input.value = '';
            price910Input.value = '';
            price915Input.value = '';
            
            // 切換顯示
            resultDisplay.style.display = 'none';
            initialMessage.style.display = 'block';
            
            // 滾動到頂部
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // 事件監聽
        analyzeBtn.addEventListener('click', analyzeOpeningMethod);
        resetBtn.addEventListener('click', resetInputs);
        
        // 示例數據填充（方便測試）
        function fillExampleData() {
            // 只在所有輸入框都為空時填充示例數據
            if (!prevCloseInput.value && !price905Input.value && !price910Input.value && !price915Input.value) {
                prevCloseInput.value = '100.00';
                price905Input.value = '101.50';
                price910Input.value = '102.00';
                price915Input.value = '101.20';
            }
        }
        
        // 頁面載入時填充示例數據
        window.addEventListener('DOMContentLoaded', fillExampleData);
    </script>
</body>
</html>